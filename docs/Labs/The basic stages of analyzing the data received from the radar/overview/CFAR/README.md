# Обнаружение Постоянного ложного сигнального уровня (CFAR)
---

Одной важной задачей, которую выполняет радиолокационная система, является целевое обнаружение. Само обнаружение является довольно прямым. Это сравнивает сигнал с порогом. Поэтому действительная работа над обнаружением придумывает соответствующий порог. В общем случае порог является функцией и вероятности обнаружения и вероятности ложного предупреждения.

Во многих системах фазированной решетки, из-за стоимости, сопоставленной с ложным обнаружением, желательно иметь порог обнаружения, который не только максимизирует вероятность обнаружения, но также и сохраняет вероятность ложного предупреждения ниже предварительно установленного уровня.

Существует обширная литература по тому, как определить порог обнаружения. Читатели могут интересоваться Обнаружением Сигнала в Белом Гауссовом шуме и Обнаружением Сигнала Используя Несколько Демонстрационных примеров для некоторых известных результатов. Однако все эти классические результаты основаны на теоретических вероятностях и ограничиваются белым Гауссовым шумом с известным отклонением (степень). В действительных приложениях часто окрашивается шум, и его степень неизвестна.

Технология CFAR решает эти проблемы. В CFAR, когда обнаружение необходимо для данной ячейки, которую часто называют как ячейка под тестом (CUT), шумовая мощность оценивается от соседних ячеек. Затем порог обнаружения, T, дают

$$T = \alpha P_n$$

где $P_n$ - оценка шумовой мощности и α масштабный коэффициент, названный пороговым фактором.

От уравнения ясно, что порог адаптируется к данным. Можно показать это с соответствующим пороговым фактором, $\alpha$, получившаяся вероятность ложного предупреждения может быть сохранена в константе, отсюда имя CFAR.

## Ячейка, составляющая в среднем обнаружение CFAR

Ячейка, составляющая в среднем детектор CFAR, является, вероятно, наиболее широко используемым детектором CFAR. Это также используется в качестве базового сравнения для других методов CFAR. В ячейке, составляющей в среднем детектор CFAR, шумовые выборки извлечены и из ведущих и из отстающих ячеек (названный учебными ячейками) вокруг CUT. Шумовая оценка может быть вычислена как

$$P_n = \frac{1}{N}\sum^{N}_{m = 1}{x_m}$$

где $N$ - количество учебных ячеек и $x_m$ выборка в каждой учебной ячейке. Если $x_m$ оказывается, выход квадратичного детектора, затем $P_n$ представляет предполагаемую шумовую мощность. В общем случае количество продвижения и отставания учебных ячеек является тем же самым. Ячейки охраны помещаются смежные с CUT, и продвижение и отставание его. Цель этих защитных ячеек состоит в том, чтобы избежать компонентов сигнала от утечки в учебную ячейку, которая могла оказать негативное влияние на шумовую оценку.

Следующий рисунок показывает отношение среди этих ячеек для 1D случая.

<img src = "https://farm2.staticflickr.com/1652/25170561054_2e4c18a434_z.jpg" alt = "drawing" width = "350" align = 'center'>

С вышеупомянутой ячейкой, составляющей в среднем детектор CFAR, принимая данные, переданные в детектор, от одного импульса, i.e., никакое импульсное интегрирование не включило, пороговый фактор может быть записан как

$$\alpha = N(P_{f\alpha}^{-1/N}-1)$$

где $P_{f\alpha}$ - желаемый ложный сигнальный уровень.


```python
# TODO: Реализовать функция CFAR
# TODO: peaks_idx = detect_peaks(powers, num_train = 10, num_guard = 2, rate_fa = 0.3);

# TODO: plt.plot(ranges, powers, 'b-', linewidth = 2);
# TODO: plt.plot(ranges[peaks_idx], powers[peaks_idx], 'ro', linewidth = 2);
```

1. [Detect peaks with CFAR algorithm](https://tsaith.github.io/detect-peaks-with-cfar-algorithm.html)
2. [Обнаружение Постоянного ложного сигнального уровня (CFAR)](https://docs.exponenta.ru/phased/ug/constant-false-alarm-rate-cfar-detection.html)
